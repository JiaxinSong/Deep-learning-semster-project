import numpy as np
import openpyxl
from openpyxl import Workbook, load_workbook


def counting( d1, s2,d2, f):# d2=k
    ops=s2*s2*f*f*d1*d2*2
    par=f*f*d1*d2
    return ops,par

def counting2(s2,d2):
    ops=d2*s2*s2
    par=0
    return ops,par


def main():
    x=[]
    y=[]
    wb = Workbook()
    ws = wb.active
    ws.title = "counting 1"

    layer=[[3,416,32,3,1,0],
           [32,208,64,3,2,0],
           [64,208,32,1,1,0],
           [32,208,64,3,1,0],
           [64,208,64,0,0,1],
           [64,104,128,3,2,0],
           [128,104,64,1,1,0],
           [64,104,128,3,1,0],
           [128,104,128,0,0,1],
           [128,104,64,1,1,0],
           [64,104,128,3,1,0],
           [128,104,128,0,0,1],
           [128,52,256,3,2,0],
           [256,52,128,1,1,0],
           [128,52,256,3,3,0],
           [256,52,256,0,0,1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256, 52, 128, 1, 1, 0],
           [128, 52, 256, 3, 3, 0],
           [256, 52, 256, 0, 0, 1],
           [256,26,512,3,2,0],
           [512,26,256,1,1,0],
           [256,26,512,3,1,0],
           [512,26,512,0,0,1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512, 26, 256, 1, 1, 0],
           [256, 26, 512, 3, 1, 0],
           [512, 26, 512, 0, 0, 1],
           [512,13,1024,3,2,0],
           [1024,13,512,1,1,0],
           [512,13,1024,3,1,0],
           [1024,13,1024,0,0,1],
           [1024, 13, 512, 1, 1, 0],
           [512, 13, 1024, 3, 1, 0],
           [1024, 13, 1024, 0, 0, 1],
           [1024, 13, 512, 1, 1, 0],
           [512, 13, 1024, 3, 1, 0],
           [1024, 13, 1024, 0, 0, 1],
           [1024, 13, 512, 1, 1, 0],
           [512, 13, 1024, 3, 1, 0],
           [1024, 13, 1024, 0, 0, 1],
           [1024,13,512,1,1,0],
           [512,13,1024,3,1,0],
           [1024,13,512,1,1,0],
           [512,13,1024,3,1,0],
           [1024,13,512,1,1,0],
           [512,13,1024,3,1,0],
           [1024,13,255,1,1,0]












           ]

    p=2
    for i in layer:
        if i[5]==0:
            a, b =counting(i[0],i[1],i[2],i[3])
            x.append(a)
            y.append(b)
            ps=str(i[3])
            st=str(i[4])
            os=str(i[1])
            od=str(i[2])
            l = ws.cell(row=p, column=1, value='convolution')
            l = ws.cell(row=p, column=2, value=ps+'*'+ps+'/'+st)
            u = ws.cell(row=p, column=3, value=os+'*'+os+'*'+od)
            d = ws.cell(row=p, column=5, value=a)
            o = ws.cell(row=p, column=4, value=b)
            p=p+1
        if i[5]==1:
            a,b=counting2(i[1],i[2])
            x.append(a)
            y.append(b)
            ps = str(i[3])
            st = str(i[4])
            os = str(i[1])
            od = str(i[2])
            l = ws.cell(row=p, column=1, value='sum')
            u = ws.cell(row=p, column=3, value=os + '*' + os + '*' + od)
            d = ws.cell(row=p, column=5, value=a)
            o = ws.cell(row=p, column=4, value=b)
            p = p + 1

  # print(x)
 #  print(y)


    wb.save('document1.xlsx')



if __name__ == "__main__":
    main()